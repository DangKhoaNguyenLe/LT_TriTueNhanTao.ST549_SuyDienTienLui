<!DOCTYPE html>
<html lang="vi">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Chatbot Demo</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
   <link rel="stylesheet" href="/view/accsets/style.css">
</head>
<style>
   #chat-window {
      width: 100%;
      height: 500px;
      padding: 10px;
   }

   .message {
      margin-bottom: 10px;
      padding: 8px 12px;
      border-radius: 10px;
      max-width: 80%;
   }

   .user-message {
      background-color: #0d6efd;
      color: white;
      align-self: flex-end;
      margin-left: auto;
   }

   .bot-message {
      background-color: #e9ecef;
      color: black;
      align-self: flex-start;
      margin-right: auto;
   }

   .card-footer {
      position: fixed;
      left: 50%;
      width: 60%;
      transform: translateX(-50%);
      bottom: 20px;
      border: none;
      background: none;
   }

   .card-footer .input-group {
      width: 100%;
   }
</style>

<body class="bg-light">
   <div class="container mt-2">
      <div class="row d-flex justify-content-center">
         <div class="col-md-12">
            <div class="card" style="border: none;">
               <div class="card-header bg-success text-white">
                  <h5 class="mb-0">Chatbot demo</h5>
               </div>
               <div class="card-body d-flex flex-column" id="chat-window">
                  <div class="message bot-message">
                     Chatbot luật sinh rule - base
                  </div>
               </div>
               <div class="card-footer">
                  <form id="chat-form">
                     <div class="input-group">
                        <input type="text" id="user-input" class="form-control" placeholder="Nhập văn bản..."
                           autocomplete="off">
                        <button type="submit" class="btn btn-outline-primary">Gửi</button>
                     </div>
                  </form>
               </div>
            </div>
         </div>
      </div>
   </div>

   <script>
      document.getElementById("chat-form").addEventListener("submit", async function (e) {
         e.preventDefault();

         const input = document.getElementById("user-input");
         const userText = input.value.trim();
         if (!userText) return;

         const chatWindow = document.getElementById("chat-window");
         chatWindow.innerHTML += `<div class="message user-message text-end">${userText}</div>`;

         input.value = "";

         const response = await fetch("/chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ data: userText })
         });

         const result = await response.text();

         chatWindow.innerHTML += `<div class="message bot-message text-success">${result}</div>`;
         chatWindow.scrollTop = chatWindow.scrollHeight;
      });
   </script>
</body>

</html>